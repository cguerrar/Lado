@model Lado.Models.Agencia
@{
    ViewData["Title"] = "Registrar Agencia";
    Layout = "_Layout";
}

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            @if (TempData["Error"] != null)
            {
                <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                    <i class="fas fa-exclamation-circle me-2"></i>@TempData["Error"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }
            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success alert-dismissible fade show mb-4" role="alert">
                    <i class="fas fa-check-circle me-2"></i>@TempData["Success"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }

            <div class="card shadow-sm border-0" style="border-radius: 20px;">
                <div class="card-body p-5">
                    <div class="text-center mb-4">
                        <div class="d-inline-flex align-items-center justify-content-center rounded-circle mb-3"
                             style="width: 80px; height: 80px; background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);">
                            <i class="fas fa-bullhorn text-white" style="font-size: 32px;"></i>
                        </div>
                        <h2 class="fw-bold mb-2">Registra tu Agencia</h2>
                        <p class="text-muted">Promociona tu marca en Lado y llega a miles de usuarios</p>
                    </div>

                    @if (!ViewData.ModelState.IsValid)
                    {
                        <div class="alert alert-warning mb-4">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Por favor revisa los siguientes campos:</strong>
                            <ul class="mb-0 mt-2">
                                @foreach (var modelState in ViewData.ModelState.Values)
                                {
                                    foreach (var error in modelState.Errors)
                                    {
                                        <li>@error.ErrorMessage</li>
                                    }
                                }
                            </ul>
                        </div>
                    }

                    <form asp-action="Registrar" method="post" enctype="multipart/form-data">
                        @Html.AntiForgeryToken()

                        <div class="row g-4">
                            <div class="col-12">
                                <h5 class="fw-semibold mb-3"><i class="fas fa-building me-2 text-primary"></i>Informacion de la Empresa</h5>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-medium">Nombre de la Empresa *</label>
                                <input asp-for="NombreEmpresa" class="form-control form-control-lg" placeholder="Mi Empresa S.A." required />
                                <span asp-validation-for="NombreEmpresa" class="text-danger"></span>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-medium">Razon Social</label>
                                <input asp-for="RazonSocial" class="form-control form-control-lg" placeholder="Razon social legal" />
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-medium">RUT</label>
                                <input asp-for="NIF" class="form-control form-control-lg" placeholder="76.123.456-7" />
                            </div>

                            <div class="col-md-6">
                                <label class="form-label fw-medium">Telefono</label>
                                <input asp-for="Telefono" class="form-control form-control-lg" placeholder="+56 9 1234 5678" />
                            </div>

                            <div class="col-12">
                                <label class="form-label fw-medium">Sitio Web</label>
                                <input asp-for="SitioWeb" class="form-control form-control-lg" placeholder="https://www.miempresa.com" />
                            </div>

                            <div class="col-12">
                                <label class="form-label fw-medium">Descripcion de la Empresa</label>
                                <textarea asp-for="Descripcion" class="form-control" rows="3" placeholder="Describe brevemente tu empresa y sus servicios..."></textarea>
                            </div>

                            <div class="col-12 mt-4">
                                <h5 class="fw-semibold mb-3"><i class="fas fa-map-marker-alt me-2 text-primary"></i>Direccion</h5>
                            </div>

                            <div class="col-12">
                                <label class="form-label fw-medium">Direccion</label>
                                <input asp-for="Direccion" class="form-control form-control-lg" placeholder="Calle, numero, piso..." />
                            </div>

                            <div class="col-md-4">
                                <label class="form-label fw-medium">Ciudad</label>
                                <input asp-for="Ciudad" class="form-control form-control-lg" placeholder="Santiago" />
                            </div>

                            <div class="col-md-4">
                                <label class="form-label fw-medium">Pais</label>
                                <select asp-for="Pais" class="form-select form-select-lg">
                                    <option value="">Selecciona un pais</option>
                                    <option value="CL" selected>Chile</option>
                                    <option value="AR">Argentina</option>
                                    <option value="CO">Colombia</option>
                                    <option value="PE">Peru</option>
                                    <option value="MX">Mexico</option>
                                    <option value="ES">Espana</option>
                                    <option value="US">Estados Unidos</option>
                                </select>
                            </div>

                            <div class="col-md-4">
                                <label class="form-label fw-medium">Codigo Postal</label>
                                <input asp-for="CodigoPostal" class="form-control form-control-lg" placeholder="8320000" />
                            </div>

                            <div class="col-12 mt-4">
                                <h5 class="fw-semibold mb-3"><i class="fas fa-image me-2 text-primary"></i>Logo de la Empresa</h5>
                            </div>

                            <div class="col-12">
                                <div class="border rounded-3 p-4 text-center" style="border-style: dashed !important;">
                                    <input type="file" name="logo" id="logoInput" class="d-none" accept="image/*" onchange="previewLogo(this)" />
                                    <label for="logoInput" class="cursor-pointer d-block">
                                        <div id="logoPreview" class="mb-3" style="display: none;">
                                            <img id="logoImg" src="" alt="Preview" class="rounded" style="max-height: 150px;" />
                                        </div>
                                        <div id="logoPlaceholder">
                                            <i class="fas fa-cloud-upload-alt text-muted mb-2" style="font-size: 48px;"></i>
                                            <p class="text-muted mb-0">Haz clic para subir el logo de tu empresa</p>
                                            <small class="text-muted">PNG, JPG hasta 5MB</small>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div class="col-12 mt-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="terminos" required>
                                    <label class="form-check-label" for="terminos">
                                        Acepto los <a href="#" class="text-primary">terminos y condiciones</a> del servicio de publicidad
                                    </label>
                                </div>
                            </div>

                            <div class="col-12 mt-4">
                                <button type="submit" class="btn btn-primary btn-lg w-100 py-3 fw-semibold" style="border-radius: 12px;">
                                    <i class="fas fa-paper-plane me-2"></i>Enviar Solicitud
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="text-center mt-4">
                <a href="/Feed" class="text-muted text-decoration-none">
                    <i class="fas fa-arrow-left me-2"></i>Volver al Feed
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    .cursor-pointer { cursor: pointer; }
    .form-control:focus, .form-select:focus {
        border-color: #2563eb;
        box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.15);
    }
</style>

@section Scripts {
<script>
function previewLogo(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('logoImg').src = e.target.result;
            document.getElementById('logoPreview').style.display = 'block';
            document.getElementById('logoPlaceholder').style.display = 'none';
        }
        reader.readAsDataURL(input.files[0]);
    }
}
</script>
}
